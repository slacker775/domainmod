{% extends 'base.html.twig' %}

{% block title %}
Dashboard
{% endblock %}

{% block page_content %}
<div class="row">
	<div class="col-md-6">
		<div class="card card-default">
		<div class="card-header">
		<h3 class="card-title"><i class="fas fa-exclamation-triangle"></i>Domain Details</h3></div>
			<div class="card-body">
				<div class="row">

					<div class="col-lg-3 col-6">
					{% embed '@AdminLTE/Widgets/smallbox-widget.html.twig' with {
						'solid': 'success',
						'icon': 'far fa-bookmark'
					} %}
						{% block box_text %}
							Domains
						{% endblock %}
						{% block box_number %}
							{{ activeDomainCount }}
						{% endblock %}
						{% block box_after %}
							<a class="small-box-footer" href="{{ path('domain_index') }}">View <i class="fas fa-arrow-circle-right"></i></a>
						{% endblock %}
					{% endembed %}
					</div> <!-- /.col-lg-3 -->

					<div class="col-lg-3 col-6">
						{% embed '@AdminLTE/Widgets/smallbox-widget.html.twig' with {
							'solid': 'success',
							'icon': 'far fa-bookmark'
						} %}
							{% block box_text %}
								SSL Certificates
							{% endblock %}
							{% block box_number %}
								{{ activeCertCount }}
							{% endblock %}
							{% block box_after %}
								<a class="small-box-footer" href="{{ path('ssl_cert_index') }}">View <i class="fas fa-arrow-circle-right"></i></a>
							{% endblock %}
						{% endembed %}
					</div> <!-- /.col-lg-3 -->

					{% if domainsSold > 0 %}
						<div class="col-lg-3 col-6">
							{% embed '@AdminLTE/Widgets/smallbox-widget.html.twig' with {
								'solid': 'info',
								'icon': 'far fa-bookmark'
							} %}
								{% block box_text %}
									Sold Domains
								{% endblock %}
								{% block box_number %}
									{{ domainsSold }}
								{% endblock %}
								{% block box_after %}
									<a class="small-box-footer" href="{{ path('domain_index', { 'domain_filter[status]': 10 }) }}">View <i class="fas fa-arrow-circle-right"></i></a>
								{% endblock %}
							{% endembed %}
						</div> <!-- /.col-lg-3 -->
					{% endif %}

				</div> <!-- /.row -->

				<!--  Expiration Panels -->
				{% if expiringDomains > 0 or expiringSslCerts > 0 %}
				<div class="row">

					{% if expiringDomains > 0 %}
						<div class="col-lg-3 col-6">
							{% embed '@AdminLTE/Widgets/smallbox-widget.html.twig' with {
								'solid': 'danger',
								'icon': 'far fa-bookmark'
							} %}
								{% block box_text %}
									Expiring Domains
								{% endblock %}
								{% block box_number %}
									{{ expiringDomains }}
								{% endblock %}
								{% block box_after %}
									<a class="small-box-footer" href="{{ path('domain_index', { 'domain_filter[expiringBetween]': expiringBetween }) }}">View <i class="fas fa-arrow-circle-right"></i></a>
								{% endblock %}
							{% endembed %}
						</div> <!-- /.col-lg-3 -->
					{% endif %}

					{% if expiringSslCerts > 0 %}
						{% if expiringSslCerts > 0 %}
							<div class="col-lg-3 col-6">
								{% embed '@AdminLTE/Widgets/smallbox-widget.html.twig' with {
									'solid': 'danger',
									'icon': 'far fa-bookmark'
								} %}
									{% block box_text %}
										Expiring Certs
									{% endblock %}
									{% block box_number %}
										{{ expiringSslCerts }}
									{% endblock %}
									{% block box_after %}
										<a class="small-box-footer" href="{{ path('ssl_cert_index', { 'ssl_cert_filter[expiringBetween]': expiringBetween }) }}">View <i class="fas fa-arrow-circle-right"></i></a>
									{% endblock %}
								{% endembed %}
							</div> <!-- /.col-lg-3 -->
						{% endif %}
					{% endif %}
				</div> <!-- /.row -->
				<!--  /Expiration Panels -->
				{% endif %}

				<!-- Domain Queue -->
				{% if queueProcessing > 0 or queuePending > 0 or queueFinished > 0 %}
				<div class="row">
					<h3 style="padding-left: 20px;">Domain Queue</h3>

					{% if queuePending %}
					{{ _self.displayPanel('Pending', queuePending, 'yellow', 'clock', path('queue')) }}
					{% endif %}

					{% if queueProcessing %}
					{{ _self.displayPanel('Processing', queueProcessing, 'yellow', 'clock', path('queue')) }}
					{% endif %}

					{% if queueFinished %}
					{{ _self.displayPanel('Finished', queueFinished, 'green', 'checkmark-circled', path('queue')) }}
					{% endif %}

				</div>
				{% endif %}
				<!-- /Domain Queue -->

				<!-- Domain Panels -->
				{% if domainsPendingRenewal + domainsPendingRegistration + domainsPendingTransfer + domainsPendingOther > 0 %}
				<div class="row">
					<h3 style="padding-left: 20px;">Pending (Domains)</h3>

					{{ _self.displayPanel('Pending Renewals', domainsPendingRenewal, 'red', 'clock', path('app.legacy.domains__index', { is_active: '3'})) }}

					{{ _self.displayPanel('Pending Registrations', domainsPendingRegistration, 'yellow', 'clock', path('app.legacy.domains__index', { is_active: '5'})) }}

					{{ _self.displayPanel('Pending Transfers', domainsPendingTransfer, 'aqua', 'clock', path('app.legacy.domains__index', { is_active: '2'})) }}

					{{ _self.displayPanel('Pending (Other)', domainsPendingOther, 'green', 'clock', path('app.legacy.domains__index', { is_active: '4'})) }}
				</div>
				<!-- /Domain Panels -->
				{% endif %}

				<!-- SSL Panels -->
				{% if sslPendingRenewal > 0 or sslPendingRegistration > 0 or sslPendingOther > 0 %}
				<div class="row">
					<h3 style="padding-left: 20px;">Pending (SSL Certificates)</h3>

					{% if sslPendingRenewal > 0 %}
					{{ _self.displayPanel('Pending Renewals', 0, 'red', 'clock', path('ssl_cert_index', { is_active: '3'})) }}
					{% endif %}

					{% if sslPendingRegistration > 0 %}
					{{ _self.displayPanel('Pending Registrations', 0, 'yellow', 'clock', path('ssl_cert_index', { is_active: '5'})) }}
					{% endif %}

					{% if sslPendingOther > 0 %}
					{{ _self.displayPanel('Pending (Other)', 0, 'green', 'clock', path('ssl_cert_index', { is_active: '4'})) }}
					{% endif %}
				</div>
				{% endif %}
				<!-- /SSL Panels -->

			</div>
			<!-- /.card-body -->
		</div>
		<!-- /.card -->
	</div>
	<!-- /.col-md-6 -->
</div>
<!-- /.row -->
{% endblock %}

{% macro displayPanel(title, count, color, icon, url) %}
<div class="col-lg-3 col-xs-6">
	<div class="small-box bg-{{ color }}">
		<div class="inner">
			<h3>
				{{ count }}
			</h3>
			<p>
				{{ title }}
			</p>
		</div>
		<div class="icon">
			<i class="ion ion-{{ icon }}" style="padding-top: 16px;"></i>
		</div>
		{% if count != 0 %}
		<a href="{{ url }}" class="small-box-footer">View <i
			class="fa fa-arrow-circle-right"></i></a>
		{% endif %}
	</div>
</div>
{% endmacro %}